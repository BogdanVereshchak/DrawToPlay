Draw-to-Play: Система генерації ігрових рівнів на основі комп'ютерного зору

Draw-to-Play — це програмний комплекс, призначений для автоматизованого створення ігрових рівнів жанру "платформер" без необхідності програмування. Система використовує методи комп'ютерного зору (Computer Vision) для аналізу фотографічних зображень рукописних схем та їх конвертації в інтерактивні сцени на базі ігрового рушія Godot Engine.

Функціональні можливості

Автоматизована конвертація: Швидка обробка вхідних зображень та генерація ігрового середовища.

Алгоритмічне розпізнавання: Використання бібліотеки OpenCV для нівелювання артефактів освітлення (тіні, відблиски), апроксимації кривих ліній та класифікації геометричних форм.

Колірне кодування об'єктів: Ідентифікація ігрових елементів на основі спектрального аналізу кольорів маркера.

Графічний інтерфейс користувача (GUI): Інструментарій для завантаження зображень, налаштування параметрів сканування та запуску симуляції.

Режими роботи: Підтримка режиму попереднього перегляду результатів аналізу та режиму безпосередньої гри.

Інструкція користувача

Для забезпечення коректної роботи алгоритмів розпізнавання геометрії рівня необхідно дотримуватися наступних вимог при створенні схеми:

Використовувати чистий білий аркуш паперу без лініювання або клітинок.

Використовувати насичені маркери або фломастери для забезпечення високої контрастності ліній.

Забезпечити рівномірне освітлення при фотографуванні схеми для мінімізації шумів.

Схема колірного кодування

Система класифікує об'єкти на основі їх колірних характеристик відповідно до наведеної таблиці:

Колір маркера

Тип об'єкта

Опис функціональності

Чорний

Платформа

Статична колізійна поверхня (стіни, підлога).

Червоний

Ворог

Рухомий небезпечний об'єкт (NPC).

Жовтий

Монета

Колекційний предмет для нарахування балів.

Зелений

Старт

Точка появи гравця (Spawn point).

Синій

Фініш

Тригер завершення рівня.

Трикутник

Шипи

Статична небезпечна перешкода (незалежно від кольору).

Встановлення та налаштування середовища

Для розгортання проекту необхідна наявність інтерпретатора Python 3.x та Godot Engine 4.x.

1. Клонування репозиторію

git clone [https://github.com/your-username/draw-to-play.git](https://github.com/your-username/draw-to-play.git)
cd draw-to-play


2. Налаштування оточення Python

Рекомендується використання ізольованого віртуального середовища для керування залежностями.

Створення віртуального середовища:

Windows:

python -m venv venv
.\venv\Scripts\activate


macOS/Linux:

python3 -m venv venv
source venv/bin/activate


Встановлення залежностей:

pip install opencv-python numpy pillow


3. Експорт виконуваного файлу гри

Модуль сканування (Launcher) вимагає наявності скомпільованого файлу гри в кореневій директорії.

Відкрийте проект (godot_project/project.godot) у редакторі Godot.

Перейдіть у меню Project -> Export.

Експортуйте проект під назвою Game.exe (для Windows) у кореневу папку репозиторію (поряд з файлом LevelScanner.py).

4. Запуск програми

python LevelScanner.py


Технічна реалізація

Архітектура проекту базується на послідовній обробці зображень з використанням бібліотеки OpenCV:

Попередня обробка (Preprocessing): Масштабування зображення, конвертація у колірний простір HSV, застосування адаптивної бінаризації для видалення шумів та нормалізації освітлення.

Багатопрохідне сканування (Multi-Pass Scanning):

Етап 1: Сегментація кольорових об'єктів (сутності, тригери) за допомогою масок HSV.

Етап 2: Виключення знайдених областей із загальної маски контурів.

Етап 3: Аналіз залишкової структури для виявлення статичних платформ.

Апроксимація контурів: Застосування алгоритму Рамера–Дугласа–Пекера (approxPolyDP) для спрощення полігональних кривих та перетворення рукописних ліній у геометричні примітиви.

Серіалізація даних: Експорт параметрів рівня у формат JSON (level_data.json) для подальшої обробки ігровим рушієм.

Структура проекту

DrawToPlay/
├── godot_project/          # Вихідний код проекту Godot
│   ├── scripts/            # Логіка процедурної генерації (GDScript)
│   └── scenes/             # Префаби ігрових об'єктів
├── python_scanner/         # Модулі логіки комп'ютерного зору
├── LevelScanner.py         # Головний виконувані файл (GUI + Logic)
├── level_data.json         # Проміжний файл даних рівня
├── Game.exe                # Експортований файл гри
└── README.md               # Технічна документація
